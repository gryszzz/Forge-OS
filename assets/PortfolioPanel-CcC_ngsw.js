import{j as e}from"./react-vendor-D4yGots9.js";import{m as l,a as t,b as k,C as u,L as B,I as o,B as s}from"./index-zj7ZcTer.js";function x(p,g=1){return`${Number(p||0).toFixed(g)}%`}function z({agents:p,activeAgentId:g,walletKas:S,summary:a,config:n,onConfigPatch:h,onAgentOverridePatch:r,onSelectAgent:b,onRefresh:v}){const f=Array.isArray(a==null?void 0:a.rows)?a.rows:[];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8,flexWrap:"wrap",marginBottom:14},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,color:t.text,fontWeight:700,...l},children:"Multi-Agent Portfolio Control"}),e.jsx("div",{style:{fontSize:11,color:t.dim},children:"Shared risk budget allocator across agents using quant signals, queue pressure, and configured weights."})]}),e.jsx(k,{onClick:v,size:"sm",variant:"ghost",children:"REFRESH ALLOCATOR"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:10,marginBottom:12},children:[["Wallet KAS",`${Number(S||0).toFixed(4)}`,t.accent],["Allocatable",`${Number((a==null?void 0:a.allocatableKas)||0).toFixed(4)} KAS`,t.text],["Target Budget",`${Number((a==null?void 0:a.targetBudgetKas)||0).toFixed(4)} KAS`,t.ok],["Allocated",`${Number((a==null?void 0:a.allocatedKas)||0).toFixed(4)} KAS`,t.text],["Utilization",x(a==null?void 0:a.utilizationPct,1),((a==null?void 0:a.utilizationPct)||0)>=95?t.ok:t.warn],["Concentration",x(a==null?void 0:a.concentrationPct,1),((a==null?void 0:a.concentrationPct)||0)>55?t.warn:t.ok],["RW Exposure",x(Number((a==null?void 0:a.riskWeightedExposurePct)||0)*100,1),t.warn],["Agents",String(Array.isArray(p)?p.length:0),t.dim]].map(([i,c,j])=>e.jsxs(u,{p:12,children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:4},children:i}),e.jsx("div",{style:{fontSize:13,color:j,fontWeight:700,...l},children:c})]},String(i)))}),e.jsxs(u,{p:14,style:{marginBottom:12},children:[e.jsx(B,{children:"Shared Budget Settings"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:10},children:[e.jsx(o,{label:"Total Budget %",value:String(Math.round(Number((n==null?void 0:n.totalBudgetPct)||0)*1e4)/100),onChange:i=>h({totalBudgetPct:Math.max(5,Math.min(100,Number(i)||0))/100}),type:"number",suffix:"%",hint:"Share of wallet balance allocator can assign."}),e.jsx(o,{label:"Reserve",value:String((n==null?void 0:n.reserveKas)??0),onChange:i=>h({reserveKas:Math.max(0,Number(i)||0)}),type:"number",suffix:"KAS",hint:"Hard reserve before shared budget allocation."}),e.jsx(o,{label:"Max Agent Share %",value:String(Math.round(Number((n==null?void 0:n.maxAgentAllocationPct)||0)*1e4)/100),onChange:i=>h({maxAgentAllocationPct:Math.max(5,Math.min(100,Number(i)||0))/100}),type:"number",suffix:"%",hint:"Concentration cap per agent in shared budget."}),e.jsx(o,{label:"Rebalance Threshold %",value:String(Math.round(Number((n==null?void 0:n.rebalanceThresholdPct)||0)*1e4)/100),onChange:i=>h({rebalanceThresholdPct:Math.max(1,Math.min(50,Number(i)||0))/100}),type:"number",suffix:"%",hint:"Only surface rebalance deltas above this threshold."})]})]}),e.jsxs(u,{p:0,children:[e.jsx("div",{style:{padding:"11px 16px",borderBottom:`1px solid ${t.border}`},children:e.jsx("span",{style:{fontSize:11,color:t.dim,...l},children:"PORTFOLIO AGENTS â€” SHARED RISK BUDGET + CAPITAL ALLOCATOR"})}),f.length===0&&e.jsx("div",{style:{padding:16,fontSize:12,color:t.dim},children:"No agents available for allocation."}),f.map(i=>{const c=i.agentId===g,j=i.risk<=.4?t.ok:i.risk<=.7?t.warn:t.danger,C=i.action==="ACCUMULATE"?t.ok:i.action==="REDUCE"?t.danger:t.warn;return e.jsxs("div",{style:{padding:"12px 14px",borderBottom:`1px solid ${t.border}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,flexWrap:"wrap",marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{onClick:()=>b==null?void 0:b(i.agentId),style:{background:c?t.aLow:"transparent",border:`1px solid ${c?t.accent:t.border}`,color:c?t.accent:t.text,borderRadius:6,padding:"4px 8px",cursor:"pointer",fontSize:11,...l},children:i.name}),e.jsx(s,{text:i.enabled?"ENABLED":"DISABLED",color:i.enabled?t.ok:t.dim}),e.jsx(s,{text:`TPL ${String(i.strategyTemplate||"custom").toUpperCase()}`,color:t.dim}),e.jsx(s,{text:i.action,color:C}),e.jsx(s,{text:String(i.regime).replace(/_/g," "),color:t.accent}),e.jsx(s,{text:`RISK ${i.risk}`,color:j}),e.jsx(s,{text:`CAL ${String(i.calibrationTier||"healthy").toUpperCase()} ${Number(i.calibrationHealth||0).toFixed(2)}`,color:i.calibrationTier==="critical"?t.danger:i.calibrationTier==="degraded"||i.calibrationTier==="watch"?t.warn:t.ok})]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx(s,{text:`BUDGET ${i.budgetKas} KAS`,color:t.text}),e.jsx(s,{text:`CYCLE CAP ${i.cycleCapKas} KAS`,color:t.ok}),i.rebalanceDeltaKas!==0&&e.jsx(s,{text:`REBAL ${i.rebalanceDeltaKas>0?"+":""}${i.rebalanceDeltaKas} KAS`,color:i.rebalanceDeltaKas>0?t.ok:t.warn})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(150px,1fr))",gap:8,marginBottom:8},children:[e.jsxs("div",{style:{background:t.s2,borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:2},children:"Target Alloc"}),e.jsx("div",{style:{fontSize:12,color:t.text,...l},children:x(i.targetPct,1)})]}),e.jsxs("div",{style:{background:t.s2,borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:2},children:"Budget Share"}),e.jsx("div",{style:{fontSize:12,color:t.text,...l},children:x(i.budgetPct,1)})]}),e.jsxs("div",{style:{background:t.s2,borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:2},children:"Risk Weight"}),e.jsx("div",{style:{fontSize:12,color:t.text,...l},children:i.riskWeight})]}),e.jsxs("div",{style:{background:t.s2,borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:2},children:"Queue Pressure"}),e.jsx("div",{style:{fontSize:12,color:i.queuePressurePct>20?t.warn:t.dim,...l},children:x(i.queuePressurePct,1)})]}),e.jsxs("div",{style:{background:t.s2,borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:2},children:"Confidence / DataQ"}),e.jsxs("div",{style:{fontSize:12,color:t.text,...l},children:[i.confidence," / ",i.dataQuality]})]}),e.jsxs("div",{style:{background:t.s2,borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:t.dim,...l,marginBottom:2},children:"Truth Quality / Cal"}),e.jsxs("div",{style:{fontSize:12,color:t.text,...l},children:[i.truthQualityScore," / ",i.calibrationHealth]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:10},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:11,color:t.dim,...l},children:[e.jsx("input",{type:"checkbox",checked:i.enabled,onChange:d=>r==null?void 0:r(i.agentId,{enabled:d.target.checked})}),"ENABLED"]})}),e.jsx(o,{label:"Target Allocation %",value:String(i.targetPct),onChange:d=>r==null?void 0:r(i.agentId,{targetAllocationPct:Math.max(0,Math.min(100,Number(d)||0))}),type:"number",suffix:"%",hint:"Portfolio target share for this agent."}),e.jsx(o,{label:"Risk Weight",value:String(i.riskWeight),onChange:d=>r==null?void 0:r(i.agentId,{riskWeight:Math.max(0,Math.min(10,Number(d)||0))}),type:"number",hint:"Relative allocator weight when signals are favorable."})]}),e.jsx("div",{style:{marginTop:6,display:"flex",flexWrap:"wrap",gap:6},children:(i.notes||[]).map(d=>e.jsx(s,{text:d.toUpperCase(),color:t.warn},`${i.agentId}:${d}`))})]},i.agentId)})]})]})}export{z as PortfolioPanel};
