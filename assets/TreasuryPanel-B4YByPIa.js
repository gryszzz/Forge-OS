import{r as h,j as t}from"./react-vendor-D4yGots9.js";import{T as a,A as p,m as i,a as r,C as l,L as x,e as f,g as w,h as L,b,E as F,i as T,d as R,j as B,B as y}from"./index-DKkH4U3d.js";import{R as N,B as z,C as k,X as P,Y as I,T as O,c as g}from"./recharts-vendor-DqQ-4nM4.js";import"./d3-render-vendor-RkpHolfk.js";import"./d3-scale-vendor-BynLqmir.js";function G({log:m,agentCapital:D}){const[u,j]=h.useState(typeof window<"u"?window.innerWidth:1200);h.useEffect(()=>{if(typeof window>"u")return;const e=()=>j(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const o=u<760,E=o?"repeat(2,1fr)":"repeat(4,1fr)",S=o?"82px 58px 1fr":"90px 60px 90px 90px 1fr",n=m.filter(e=>e.fee!=null),d=parseFloat(n.reduce((e,s)=>e+(s.fee||0),0).toFixed(4)),v=parseFloat((d*a).toFixed(4)),C=parseFloat((d*p).toFixed(4)),A=m.filter(e=>e.type==="EXEC").length,c=n.slice(0,10).reverse().map((e,s)=>({label:`#${s+1}`,treasury:parseFloat((e.fee*a).toFixed(4)),pool:parseFloat((e.fee*p).toFixed(4))}));return t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:13,color:r.text,fontWeight:700,...i,marginBottom:4},children:"Treasury & Fee Routing"}),t.jsxs("div",{style:{fontSize:12,color:r.dim,marginBottom:16},children:["All protocol fees split automatically: ",p*100,"% agent pool · ",a*100,"% treasury."]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:E,gap:10,marginBottom:14},children:[{l:"Total Fees Paid",v:`${d} KAS`,c:r.text},{l:"Treasury Collected",v:`${v} KAS`,c:r.warn},{l:"Agent Pool",v:`${C} KAS`,c:r.ok},{l:"Exec Cycles",v:A,c:r.dim}].map(e=>t.jsxs(l,{p:14,children:[t.jsx(x,{children:e.l}),t.jsx("div",{style:{fontSize:18,color:e.c,fontWeight:700,...i},children:e.v})]},e.l))}),t.jsxs(l,{p:18,style:{marginBottom:12},children:[t.jsx(x,{children:"Treasury Address"}),t.jsx("div",{style:{fontSize:12,color:r.accent,...i,wordBreak:"break-all",marginBottom:10},children:f}),t.jsxs("div",{style:{fontSize:11,color:r.dim,marginBottom:10,...i},children:["Treasury payout mode: ",L?"ON-CHAIN ENABLED":"LEDGER-ONLY"," · per execution payout ",w," KAS"]}),t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsx(b,{onClick:()=>{var e;return(e=navigator.clipboard)==null?void 0:e.writeText(f)},variant:"ghost",size:"sm",children:"COPY"}),t.jsx(F,{href:`${T}/addresses/${f}`,label:"VERIFY ON-CHAIN ↗"})]})]}),c.length>0&&t.jsxs(l,{p:18,style:{marginBottom:12},children:[t.jsxs(x,{children:["Fee Split History (last ",c.length," cycles)"]}),t.jsx(N,{width:"100%",height:120,children:t.jsxs(z,{data:c,margin:{top:4,right:4,left:-24,bottom:0},children:[t.jsx(k,{stroke:r.border,vertical:!1}),t.jsx(P,{dataKey:"label",tick:{fill:r.dim,fontSize:10,fontFamily:"Courier New"},tickLine:!1,axisLine:!1}),t.jsx(I,{tick:{fill:r.dim,fontSize:10,fontFamily:"Courier New"},tickLine:!1,axisLine:!1,tickFormatter:e=>`${e}`}),t.jsx(O,{contentStyle:{background:r.s2,border:`1px solid ${r.border}`,borderRadius:4,...i,fontSize:11}}),t.jsx(g,{dataKey:"pool",fill:r.ok,radius:[2,2,0,0],name:"Agent Pool"}),t.jsx(g,{dataKey:"treasury",fill:r.warn,radius:[2,2,0,0],name:"Treasury"})]})})]}),t.jsxs(l,{p:0,children:[t.jsx("div",{style:{padding:"11px 16px",borderBottom:`1px solid ${r.border}`},children:t.jsx("span",{style:{fontSize:11,color:r.dim,...i},children:"FEE LEDGER — ALL ENTRIES"})}),n.slice(0,12).map((e,s)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:S,gap:8,padding:"8px 16px",borderBottom:`1px solid ${r.border}`,alignItems:"center"},children:[t.jsx("span",{style:{fontSize:11,color:r.dim,...i},children:R(e.ts)}),t.jsx("span",{style:{fontSize:11,color:B[e.type],...i,fontWeight:700},children:e.type}),!o&&t.jsxs("span",{style:{fontSize:12,color:r.text,...i},children:[e.fee," KAS"]}),!o&&t.jsxs("span",{style:{fontSize:11,color:r.warn,...i},children:[(e.fee*a).toFixed(4)," → tsy"]}),t.jsxs("div",{style:{minWidth:0},children:[t.jsx("div",{style:{fontSize:11,color:r.dim,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.msg}),((e==null?void 0:e.truthLabel)||(e==null?void 0:e.receiptProvenance))&&t.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:4},children:[(e==null?void 0:e.truthLabel)&&t.jsx(y,{text:String(e.truthLabel),color:String(e.truthLabel).includes("CHAIN CONFIRMED")?r.ok:String(e.truthLabel).includes("BACKEND CONFIRMED")?r.purple:String(e.truthLabel).includes("BROADCASTED")?r.accent:r.warn}),(e==null?void 0:e.receiptProvenance)&&t.jsx(y,{text:String(e.receiptProvenance),color:String(e.receiptProvenance).toUpperCase()==="CHAIN"?r.ok:String(e.receiptProvenance).toUpperCase()==="BACKEND"?r.purple:r.warn})]})]})]},s))]})]})}export{G as TreasuryPanel};
