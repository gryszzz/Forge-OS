import{r as $,j as r}from"./react-vendor-D4yGots9.js";import{a as e,m as S,b as me,C as O,B as g,d as ue,L as Y}from"./index-zj7ZcTer.js";const ye={},R=ye,de=String(R.VITE_DECISION_AUDIT_SIGNER_URL||"").trim(),_e=String(R.VITE_DECISION_AUDIT_SIGNER_PUBLIC_KEY_URL||"").trim(),Se=String(R.VITE_DECISION_AUDIT_SIGNER_TOKEN||"").trim(),Ie=Math.max(5e3,Number(R.VITE_DECISION_AUDIT_SIGNER_PUBLIC_KEY_CACHE_TTL_MS||3e5)),Ee=String(R.VITE_DECISION_AUDIT_SIGNER_PINNED_FINGERPRINTS||"").split(",").map(n=>n.trim()).filter(Boolean),be=/^(1|true|yes)$/i.test(String(R.VITE_DECISION_AUDIT_SIGNER_REQUIRE_PINNED||"false"));let V=null,z=null;function Q(){return Date.now()}function W(n){if(n==null)return"null";const l=typeof n;return l==="number"?Number.isFinite(n)?JSON.stringify(n):"null":l==="boolean"?n?"true":"false":l==="string"?JSON.stringify(n):Array.isArray(n)?`[${n.map(c=>W(c)).join(",")}]`:l==="object"?`{${Object.entries(n).filter(([,i])=>typeof i<"u").sort(([i],[m])=>i.localeCompare(m)).map(([i,m])=>`${JSON.stringify(i)}:${W(m)}`).join(",")}}`:"null"}function we(n){return{audit_record_version:String((n==null?void 0:n.audit_record_version)||""),hash_algo:String((n==null?void 0:n.hash_algo)||""),prompt_version:String((n==null?void 0:n.prompt_version)||""),ai_response_schema_version:String((n==null?void 0:n.ai_response_schema_version)||""),quant_feature_snapshot_hash:String((n==null?void 0:n.quant_feature_snapshot_hash)||""),decision_hash:String((n==null?void 0:n.decision_hash)||""),overlay_plan_reason:String((n==null?void 0:n.overlay_plan_reason)||""),engine_path:String((n==null?void 0:n.engine_path)||""),created_ts:Math.max(0,Math.round(Number((n==null?void 0:n.created_ts)||0)))}}function je(){if(_e)return _e;if(!de)return"";try{const n=new URL(de);return n.pathname.endsWith("/v1/audit-sign")?(n.pathname=n.pathname.replace(/\/v1\/audit-sign$/,"/v1/public-key"),n.toString()):""}catch{return""}}function pe(n){const l=String(n||"").replace(/-/g,"+").replace(/_/g,"/"),c=l.length%4===0?"":"=".repeat(4-l.length%4),i=atob(l+c),m=new Uint8Array(i.length);for(let x=0;x<i.length;x+=1)m[x]=i.charCodeAt(x);return m}function Ce(n){let l="";for(let c=0;c<n.length;c+=1)l+=String.fromCharCode(n[c]);return btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function ke(n){const l=String(n||"").replace(/-----BEGIN PUBLIC KEY-----/g,"").replace(/-----END PUBLIC KEY-----/g,"").replace(/\s+/g,"");return pe(l.replace(/\+/g,"-").replace(/\//g,"_"))}async function ge(n){const l=new TextEncoder().encode(String(n||"")),c=new Uint8Array(await crypto.subtle.digest("SHA-256",l));return Ce(c)}async function q(n){return`sha256:${await ge(String(n||""))}`}function Ae(n){return(Array.isArray(n)?n:Ee).map(c=>String(c||"").trim()).filter(Boolean)}function Ne(n){return String(n||"").trim().toUpperCase()}async function ve(n,l){const c=ke(n);if(l==="ED25519")return{key:await crypto.subtle.importKey("spki",c,{name:"Ed25519"},!1,["verify"]),verifyAlgo:{name:"Ed25519"}};if(l==="ES256")return{key:await crypto.subtle.importKey("spki",c,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),verifyAlgo:{name:"ECDSA",hash:"SHA-256"}};if(l==="RS256")return{key:await crypto.subtle.importKey("spki",c,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["verify"]),verifyAlgo:{name:"RSASSA-PKCS1-v1_5"}};throw new Error(`unsupported_alg:${l||"unknown"}`)}function Te(){return!!(V&&Q()-V.ts<Ie)}async function De(n){if(Te())return V;if(z)return z;const l=String(je()).trim();return l?(z=(async()=>{try{const c={},i=String((n==null?void 0:n.token)||Se||"").trim();i&&(c.Authorization=`Bearer ${i}`);const m=await fetch(l,{headers:c}),x=await m.json().catch(()=>({}));if(!m.ok)return null;const o=x!=null&&x.key&&typeof x.key=="object"?x.key:x,E=String((o==null?void 0:o.publicKeyPem)||(o==null?void 0:o.public_key_pem)||"");if(!E.trim())return null;const I={ts:Q(),keyId:o!=null&&o.keyId?String(o.keyId):o!=null&&o.key_id?String(o.key_id):null,alg:o!=null&&o.alg?String(o.alg):o!=null&&o.algorithm?String(o.algorithm):null,publicKeyPem:E,fingerprint:typeof(o==null?void 0:o.publicKeyFingerprint)=="string"?String(o.publicKeyFingerprint):typeof(o==null?void 0:o.public_key_fingerprint)=="string"?String(o.public_key_fingerprint):await q(E)};return V=I,I}catch{return null}finally{z=null}})(),z):null}function C(n){return{status:"error",verified:!1,pinMatched:null,pinsConfigured:!1,keyFingerprint:null,keyId:null,alg:null,source:"none",verifiedAtTs:Q(),...n}}function Pe(){var n;return!!((n=globalThis.crypto)!=null&&n.subtle&&globalThis.TextEncoder&&globalThis.atob&&globalThis.btoa)}async function Ue(n,l){if(!Pe())return C({status:"unsupported",detail:"webcrypto_unavailable"});const c=n==null?void 0:n.audit_record,i=c==null?void 0:c.crypto_signature;if(!c||!i||String((i==null?void 0:i.status)||"").toLowerCase()!=="signed")return C({status:"missing_signature",detail:"crypto_signature_not_signed"});const m=String((i==null?void 0:i.sig_b64u)||"").trim();if(!m)return C({status:"missing_signature",detail:"sig_b64u_missing"});const x=we(c);if(!x.decision_hash||!x.quant_feature_snapshot_hash)return C({status:"missing_payload",detail:"audit_payload_missing_hashes"});const o=W(x);let E=String((i==null?void 0:i.public_key_pem)||""),I=null,b="none",a=null;if(E.trim())b="embedded",I=await q(E);else{if(a=await De(l),!(a!=null&&a.publicKeyPem))return C({status:"error",detail:"public_key_not_available",keyId:String((i==null?void 0:i.key_id)||"")||null,alg:String((i==null?void 0:i.alg)||"")||null});E=a.publicKeyPem,I=a.fingerprint||await q(E),b="fetched"}const K=Ae(l==null?void 0:l.pinnedFingerprints),w=K.length>0,v=w?K.includes(String(I||"")):null;if(be&&w&&!v)return C({status:"unpinned",verified:!1,pinMatched:!1,pinsConfigured:w,keyFingerprint:I,keyId:String((i==null?void 0:i.key_id)||(a==null?void 0:a.keyId)||"")||null,alg:String((i==null?void 0:i.alg)||(a==null?void 0:a.alg)||"")||null,source:b,detail:"signer_key_not_pinned"});try{const T=String((i==null?void 0:i.payload_hash_sha256_b64u)||"").trim();if(T&&await ge(o)!==T)return C({status:"invalid",detail:"payload_hash_mismatch",keyFingerprint:I,keyId:String((i==null?void 0:i.key_id)||(a==null?void 0:a.keyId)||"")||null,alg:String((i==null?void 0:i.alg)||(a==null?void 0:a.alg)||"")||null,source:b,pinsConfigured:w,pinMatched:v});const k=Ne((i==null?void 0:i.alg)||(a==null?void 0:a.alg)||""),{key:y,verifyAlgo:s}=await ve(E,k),P=await crypto.subtle.verify(s,y,pe(m),new TextEncoder().encode(o));return C({status:P?"verified":"invalid",verified:!!P,pinMatched:v,pinsConfigured:w,keyFingerprint:I,keyId:String((i==null?void 0:i.key_id)||(a==null?void 0:a.keyId)||"")||null,alg:k||null,source:b,detail:P?void 0:"signature_verify_failed"})}catch(T){const k=String((T==null?void 0:T.message)||"verify_failed");return/unsupported_alg/i.test(k)?C({status:"unsupported",detail:k,pinMatched:v,pinsConfigured:w,keyFingerprint:I,keyId:String((i==null?void 0:i.key_id)||(a==null?void 0:a.keyId)||"")||null,alg:String((i==null?void 0:i.alg)||(a==null?void 0:a.alg)||"")||null,source:b}):C({status:"error",detail:k,pinMatched:v,pinsConfigured:w,keyFingerprint:I,keyId:String((i==null?void 0:i.key_id)||(a==null?void 0:a.keyId)||"")||null,alg:String((i==null?void 0:i.alg)||(a==null?void 0:a.alg)||"")||null,source:b})}}function Be(n){const l=n==null?void 0:n.audit_record,c=l==null?void 0:l.crypto_signature,i=String((l==null?void 0:l.decision_hash)||"").trim(),m=String((c==null?void 0:c.sig_b64u)||"").trim(),x=String((c==null?void 0:c.key_id)||"").trim();return!i||!m?"":`${i}|${x}|${m.slice(0,48)}`}function $e({decisions:n,queue:l=[],loading:c,onRun:i}){var Z,X,ee,te,ne,re,ie;const[m,x]=$.useState(typeof window<"u"?window.innerWidth:1200);$.useEffect(()=>{if(typeof window>"u")return;const t=()=>x(window.innerWidth);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const o=m<760,E=o?"repeat(2,1fr)":"repeat(4,1fr)",I=o?"78px 108px 1fr":"90px 200px 96px 88px 1fr",b=Array.isArray(l)?l:[],[a,K]=$.useState({}),w=$.useRef(new Set),v=$.useMemo(()=>{var u,f;const t=new Map;for(const _ of b){if(!_||(_==null?void 0:_.metaKind)==="treasury_fee")continue;const h=String(((f=(u=_==null?void 0:_.dec)==null?void 0:u.audit_record)==null?void 0:f.decision_hash)||"").trim();if(!h)continue;const p=t.get(h);(!p||Number((_==null?void 0:_.ts)||0)>Number((p==null?void 0:p.ts)||0))&&t.set(h,_)}return t},[b]),J=t=>{var _,h;if(!(t!=null&&t.dec))return null;const u=String(((h=(_=t==null?void 0:t.dec)==null?void 0:_.audit_record)==null?void 0:h.decision_hash)||"").trim();return u&&v.has(u)?v.get(u):b.filter(p=>(p==null?void 0:p.metaKind)!=="treasury_fee"&&(p==null?void 0:p.dec)===t.dec).sort((p,j)=>Number((j==null?void 0:j.ts)||0)-Number((p==null?void 0:p.ts)||0))[0]||null},T=t=>{if(!t)return{text:"ESTIMATED",color:e.warn};const u=String((t==null?void 0:t.receipt_imported_from)||"").toLowerCase(),f=String((t==null?void 0:t.receipt_source_path)||"").toLowerCase(),_=String((t==null?void 0:t.confirm_ts_source)||"").toLowerCase();return u==="callback_consumer"||f.includes("callback-consumer")?{text:"BACKEND",color:e.purple}:u==="kaspa_api"||_==="chain"?{text:"CHAIN",color:e.ok}:{text:"ESTIMATED",color:e.warn}},k=t=>{const u=J(t),f=T(u);if(!u)return{text:"SIMULATED",color:e.dim,provenance:{text:"ESTIMATED",color:e.warn}};if(String((u==null?void 0:u.status)||"")!=="signed")return{text:"ESTIMATED",color:e.warn,provenance:f};const _=String((u==null?void 0:u.receipt_lifecycle)||"submitted");return _==="confirmed"?f.text==="BACKEND"?{text:"BACKEND CONFIRMED",color:e.purple,provenance:f}:f.text==="CHAIN"?{text:"CHAIN CONFIRMED",color:e.ok,provenance:f}:{text:"ESTIMATED",color:e.warn,provenance:f}:_==="broadcasted"||_==="pending_confirm"||_==="submitted"?{text:"BROADCASTED",color:e.warn,provenance:f}:{text:"ESTIMATED",color:e.warn,provenance:f}},y=n[0],s=y==null?void 0:y.dec,P=(s==null?void 0:s.action)==="ACCUMULATE"?e.ok:(s==null?void 0:s.action)==="REDUCE"?e.danger:(s==null?void 0:s.action)==="REBALANCE"?e.purple:e.warn,F=String((s==null?void 0:s.decision_source)||(y==null?void 0:y.source)||"ai"),fe=F==="hybrid-ai"?e.accent:F==="quant-core"?e.text:F==="fallback"?e.warn:e.ok,d=(s==null?void 0:s.quant_metrics)||null,U=y?k(y):null,A=((Z=s==null?void 0:s.audit_record)==null?void 0:Z.crypto_signature)||null,D=(ee=(X=y==null?void 0:y.dec)==null?void 0:X.audit_record)!=null&&ee.decision_hash&&((te=a[String(y.dec.audit_record.decision_hash)])==null?void 0:te.result)||null,H=t=>t==null||t===""?"—":typeof t=="number"?Number.isFinite(t)?Math.abs(t)>=1e3?String(Math.round(t)):String(t):"—":typeof t=="boolean"?t?"yes":"no":String(t);$.useEffect(()=>{var f,_;let t=!1;const u=(Array.isArray(n)?n:[]).slice(0,24);for(const h of u){const p=(f=h==null?void 0:h.dec)==null?void 0:f.audit_record,j=String((p==null?void 0:p.decision_hash)||"").trim();if(!j||String(((_=p==null?void 0:p.crypto_signature)==null?void 0:_.status)||"").toLowerCase()!=="signed")continue;const N=Be(h.dec);if(!N)continue;const B=a[j];(B==null?void 0:B.cacheKey)!==N&&(w.current.has(N)||(w.current.add(N),Ue(h.dec).then(G=>{t||K(M=>{const L=M[j];return(L==null?void 0:L.cacheKey)===N?M:{...M,[j]:{cacheKey:N,result:G}}})}).finally(()=>{w.current.delete(N)})))}return()=>{t=!0}},[a,n]);const he=t=>t?t.status==="verified"?r.jsx(g,{text:"CRYPTO VERIFIED",color:e.ok}):t.status==="unpinned"?r.jsx(g,{text:"UNPINNED KEY",color:e.warn}):t.status==="invalid"?r.jsx(g,{text:"CRYPTO INVALID",color:e.danger}):t.status==="unsupported"?r.jsx(g,{text:"VERIFY UNSUPPORTED",color:e.dim}):t.status==="error"?r.jsx(g,{text:"VERIFY ERROR",color:e.warn}):r.jsx(g,{text:"VERIFY UNKNOWN",color:e.dim}):r.jsx(g,{text:"CRYPTO VERIFY…",color:e.dim}),xe=t=>{if(!t)return"crypto verify pending";const u=[`verify ${String(t.status||"unknown")}`,t.alg?String(t.alg):"",t.keyFingerprint?`fp ${String(t.keyFingerprint).slice(0,26)}`:"",t.pinMatched===!0?"pinned":t.pinMatched===!1?"unpinned":"",t.source?`src ${t.source}`:""].filter(Boolean);return t.detail&&u.push(String(t.detail).slice(0,80)),u.join(" · ")};return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",flexDirection:o?"column":"row",justifyContent:"space-between",alignItems:o?"flex-start":"center",marginBottom:16,gap:o?8:0},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:13,color:e.text,fontWeight:700,...S},children:"Quant Intelligence Layer"}),r.jsx("div",{style:{fontSize:11,color:e.dim},children:"Deterministic quant core + AI risk overlay · Kelly sizing · regime detection · execution guardrails"})]}),r.jsx(me,{onClick:i,disabled:c,children:c?"PROCESSING...":"RUN QUANT CYCLE"})]}),c&&r.jsxs(O,{p:24,style:{textAlign:"center",marginBottom:12},children:[r.jsx("div",{style:{fontSize:12,color:e.dim,...S,marginBottom:6},children:"Running quant engine..."}),r.jsx("div",{style:{fontSize:11,color:e.dim},children:"Kaspa on-chain data → Kelly sizing → Monte Carlo → Decision"})]}),!s&&!c&&r.jsxs(O,{p:40,style:{textAlign:"center",marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,color:e.dim,...S,marginBottom:6},children:"No intelligence output yet."}),r.jsx("div",{style:{fontSize:12,color:e.dim},children:"Run a quant cycle to generate a structured trade decision with Kelly sizing and Monte Carlo confidence."})]}),s&&r.jsxs(r.Fragment,{children:[r.jsxs(O,{p:18,style:{marginBottom:10,border:`1px solid ${P}25`},children:[r.jsxs("div",{style:{display:"flex",alignItems:o?"flex-start":"center",justifyContent:"space-between",flexDirection:o?"column":"row",gap:o?8:0,marginBottom:14},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[r.jsx(g,{text:s.action,color:P}),r.jsx(g,{text:s.strategy_phase,color:e.purple}),r.jsx(g,{text:`SOURCE ${F.toUpperCase()}`,color:fe}),U&&r.jsx(g,{text:`TRUTH ${U.text}`,color:U.color}),U&&r.jsx(g,{text:`PROV ${U.provenance.text}`,color:U.provenance.color}),(d==null?void 0:d.regime)&&r.jsx(g,{text:`REGIME ${String(d.regime).replace(/_/g," ")}`,color:e.accent}),((ne=s==null?void 0:s.audit_record)==null?void 0:ne.audit_sig)&&r.jsx(g,{text:"AUDIT READY",color:e.text}),(A==null?void 0:A.status)==="signed"&&r.jsx(g,{text:"CRYPTO SIGNED",color:e.ok}),(A==null?void 0:A.status)==="signed"&&he(D),(D==null?void 0:D.pinMatched)===!0&&r.jsx(g,{text:"KEY PINNED",color:e.accent}),(D==null?void 0:D.pinMatched)===!1&&r.jsx(g,{text:"KEY UNPINNED",color:e.warn}),(A==null?void 0:A.status)==="error"&&r.jsx(g,{text:"CRYPTO SIGN ERR",color:e.warn}),r.jsx("span",{style:{fontSize:11,color:e.dim,...S},children:ue(y.ts)})]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx(g,{text:`CONF ${s.confidence_score}`,color:s.confidence_score>=.8?e.ok:e.warn}),r.jsx(g,{text:`RISK ${s.risk_score}`,color:s.risk_score<=.4?e.ok:s.risk_score<=.7?e.warn:e.danger})]})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:E,gap:10,marginBottom:14},children:[["Kelly Fraction",`${(s.kelly_fraction*100).toFixed(1)}%`,e.accent],["Monte Carlo Win",`${s.monte_carlo_win_pct}%`,e.ok],["Capital Alloc",`${s.capital_allocation_kas} KAS`,e.text],["Expected Value",`+${s.expected_value_pct}%`,e.ok],["Stop Loss",`-${s.stop_loss_pct}%`,e.danger],["Take Profit",`+${s.take_profit_pct}%`,e.ok],["Volatility",s.volatility_estimate,s.volatility_estimate==="HIGH"?e.danger:s.volatility_estimate==="MEDIUM"?e.warn:e.ok],["Liquidity Impact",s.liquidity_impact,s.liquidity_impact==="SIGNIFICANT"?e.danger:e.dim],["Engine Latency",`${s.engine_latency_ms||0} ms`,(s.engine_latency_ms||0)<=2500?e.ok:e.warn],["Data Quality",(d==null?void 0:d.data_quality_score)??"—",((d==null?void 0:d.data_quality_score)??0)>=.75?e.ok:e.warn]].map(([t,u,f])=>r.jsxs("div",{style:{background:e.s2,borderRadius:4,padding:"10px 12px"},children:[r.jsx("div",{style:{fontSize:10,color:e.dim,...S,letterSpacing:"0.06em",marginBottom:4},children:t}),r.jsx("div",{style:{fontSize:13,color:f,fontWeight:700,...S},children:u})]},t))}),r.jsxs("div",{style:{background:e.s2,borderRadius:4,padding:"10px 14px",marginBottom:12},children:[r.jsx(Y,{children:"Decision Rationale"}),r.jsx("div",{style:{fontSize:13,color:e.text,lineHeight:1.5},children:s.rationale}),s.decision_source_detail&&r.jsxs("div",{style:{fontSize:11,color:e.dim,marginTop:8,...S},children:["source detail: ",s.decision_source_detail]}),s.audit_record&&r.jsxs("div",{style:{fontSize:11,color:e.dim,marginTop:8,...S,lineHeight:1.5},children:[r.jsxs("div",{children:["audit: ",String(s.audit_record.audit_record_version||"—")," · prompt ",String(s.audit_record.prompt_version||"—")," · schema ",String(s.audit_record.ai_response_schema_version||"—")]}),r.jsxs("div",{children:["qhash ",String(s.audit_record.quant_feature_snapshot_hash||"—").slice(0,22),"… · dhash ",String(s.audit_record.decision_hash||"—").slice(0,22),"… · sig ",String(s.audit_record.audit_sig||"—").slice(0,18),"…"]}),s.audit_record.crypto_signature&&r.jsxs("div",{children:["crypto ",String(s.audit_record.crypto_signature.status||"unknown")," · ",String(s.audit_record.crypto_signature.alg||"—")," · key ",String(s.audit_record.crypto_signature.key_id||"—").slice(0,22)]}),((re=s.audit_record.crypto_signature)==null?void 0:re.status)==="signed"&&r.jsx("div",{children:xe(D)})]})]}),((ie=s.risk_factors)==null?void 0:ie.length)>0&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx(Y,{children:"Risk Factors"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:s.risk_factors.map((t,u)=>r.jsx(g,{text:t,color:e.warn},u))})]}),r.jsxs("div",{style:{background:e.aLow,borderRadius:4,padding:"10px 14px"},children:[r.jsx(Y,{color:e.accent,children:"Next Review Trigger"}),r.jsx("div",{style:{fontSize:12,color:e.text},children:s.next_review_trigger})]})]}),d&&r.jsxs(O,{p:18,style:{marginBottom:10},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:8,flexWrap:"wrap"},children:[r.jsx(Y,{children:"Quant Core Diagnostics"}),r.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[r.jsx(g,{text:`SAMPLES ${H(d.sample_count)}`,color:e.dim}),r.jsx(g,{text:`EDGE ${H(d.edge_score)}`,color:(Number(d.edge_score)||0)>0?e.ok:e.warn}),d.ai_overlay_applied&&r.jsx(g,{text:"AI OVERLAY APPLIED",color:e.accent})]})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:o?"1fr":"1fr 1fr",gap:8},children:[["Risk Profile",d.risk_profile],["Risk Ceiling",d.risk_ceiling],["Kelly Cap",d.kelly_cap],["Price USD",d.price_usd],["1-step Return %",d.price_return_1_pct],["5-step Return %",d.price_return_5_pct],["20-step Return %",d.price_return_20_pct],["Momentum Z",d.momentum_z],["EWMA Volatility",d.ewma_volatility],["DAA Velocity",d.daa_velocity],["DAA Slope",d.daa_slope],["Drawdown %",d.drawdown_pct],["Model Win Prob",d.win_probability_model],["Exposure Cap %",d.exposure_cap_pct]].map(([t,u])=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,background:e.s2,borderRadius:4,padding:"9px 12px"},children:[r.jsx("span",{style:{fontSize:11,color:e.dim,...S},children:t}),r.jsx("span",{style:{fontSize:11,color:e.text,...S},children:H(u)})]},String(t)))})]}),n.length>1&&r.jsxs(O,{p:0,children:[r.jsx("div",{style:{padding:"11px 16px",borderBottom:`1px solid ${e.border}`},children:r.jsxs("span",{style:{fontSize:11,color:e.dim,...S},children:["DECISION HISTORY — ",n.length," records"]})}),n.slice(1).map((t,u)=>{var B,G,M,L,se,oe,ae,le,ce;const f=t.dec.action==="ACCUMULATE"?e.ok:t.dec.action==="REDUCE"?e.danger:e.warn,_=k(t),h=(G=(B=t==null?void 0:t.dec)==null?void 0:B.audit_record)!=null&&G.decision_hash&&((M=a[String(t.dec.audit_record.decision_hash)])==null?void 0:M.result)||null,p=String(((L=t==null?void 0:t.dec)==null?void 0:L.decision_source)||(t==null?void 0:t.source)||"ai"),j=p==="hybrid-ai"?"HYB":p==="quant-core"?"Q":p==="fallback"?"F":"AI",N=p==="hybrid-ai"?e.accent:p==="quant-core"?e.text:p==="fallback"?e.warn:e.ok;return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:I,gap:10,padding:"9px 16px",borderBottom:`1px solid ${e.border}`,alignItems:"center"},children:[r.jsx("span",{style:{fontSize:11,color:e.dim,...S},children:ue(t.ts)}),r.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[r.jsx(g,{text:t.dec.action,color:f}),!o&&r.jsx(g,{text:j,color:N}),!o&&r.jsx(g,{text:_.text,color:_.color}),!o&&r.jsx(g,{text:_.provenance.text,color:_.provenance.color}),!o&&((ae=(oe=(se=t==null?void 0:t.dec)==null?void 0:se.audit_record)==null?void 0:oe.crypto_signature)==null?void 0:ae.status)==="signed"&&h&&r.jsx(g,{text:h.status==="verified"?"SIG✓":h.status==="unpinned"?"SIG⚠":h.status==="invalid"?"SIG✗":"SIG?",color:h.status==="verified"?e.ok:h.status==="unpinned"?e.warn:h.status==="invalid"?e.danger:e.dim})]}),!o&&r.jsxs("span",{style:{fontSize:12,color:e.text,...S},children:[t.dec.capital_allocation_kas," KAS"]}),!o&&r.jsxs("span",{style:{fontSize:12,color:t.dec.confidence_score>=.8?e.ok:e.warn,...S},children:["c:",t.dec.confidence_score]}),r.jsxs("span",{style:{fontSize:11,color:e.dim,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.dec.rationale,(ce=(le=t==null?void 0:t.dec)==null?void 0:le.audit_record)!=null&&ce.decision_hash?` · ${String(t.dec.audit_record.decision_hash).slice(0,12)}`:""]})]},u)})]})]})]})}export{$e as IntelligencePanel};
