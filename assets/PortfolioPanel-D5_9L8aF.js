import{r as F,j as e}from"./react-vendor-D4yGots9.js";import{a as t,m as n,b as Ke,C as N,I as T,B as J}from"./index-BBSk8-Kr.js";import{P as Ae,d as Ie,e as xe,T as G,R as Z,B as Le,C as q,X as ee,Y as te,f as Te,L as ge,g as he,a as pe}from"./recharts-vendor-DS4t48dv.js";import"./d3-render-vendor-RkpHolfk.js";import"./d3-scale-vendor-BynLqmir.js";const A=({value:s,color:r=t.text,fontSize:d=14})=>e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx("img",{src:"/kaspa-logo.png",alt:"KAS",width:d+2,height:d+2,style:{borderRadius:"50%"}}),e.jsx("span",{style:{fontSize:d,color:r,fontWeight:600,...n},children:s})]});function V(s,r=1){return`${Number(s||0).toFixed(r)}%`}function le(s){if(!s)return"â€”";const r=new Date(s);return`${String(r.getHours()).padStart(2,"0")}:${String(r.getMinutes()).padStart(2,"0")}:${String(r.getSeconds()).padStart(2,"0")}`}function K(s,r){if(r<=0)return null;const d=s*r;return d>=1?`$${d.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:`$${d.toFixed(4)}`}const ie=({value:s,max:r=100,color:d=t.accent,height:c=6})=>{const p=Math.min(100,Math.max(0,s/r*100));return e.jsx("div",{style:{width:"100%",height:c,background:"rgba(16,25,35,0.6)",borderRadius:c/2,overflow:"hidden"},children:e.jsx("div",{style:{width:`${p}%`,height:"100%",background:d,borderRadius:c/2,transition:"width 0.3s ease"}})})},$e=({value:s,max:r=100,color:d=t.accent,size:c=56})=>{const p=Math.min(100,Math.max(0,s/r*100)),i=c/8,x=(c-i)/2,S=2*Math.PI*x;return e.jsxs("svg",{width:c,height:c,style:{transform:"rotate(-90deg)",flexShrink:0},children:[e.jsx("circle",{cx:c/2,cy:c/2,r:x,fill:"none",stroke:"rgba(16,25,35,0.7)",strokeWidth:i}),e.jsx("circle",{cx:c/2,cy:c/2,r:x,fill:"none",stroke:d,strokeWidth:i,strokeDasharray:S,strokeDashoffset:S-p/100*S,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.5s ease"}})]})};function Re({value:s,prev:r}){const d=s>r,c=s<r,p=d?t.ok:c?t.danger:t.text;return e.jsxs("span",{style:{fontSize:11,color:p,...n,transition:"color 0.4s"},children:[d?"â–²":c?"â–¼":"â—"," ",s.toFixed(4)]})}const C=[t.accent,t.ok,t.purple,t.warn,t.danger,"#8884d8","#82ca9d","#ffc658"],Fe=({cx:s,cy:r,midAngle:d,innerRadius:c,outerRadius:p,percent:i})=>{if(i<.08)return null;const x=Math.PI/180,S=c+(p-c)*.5,v=s+S*Math.cos(-d*x),$=r+S*Math.sin(-d*x);return e.jsxs("text",{x:v,y:$,fill:t.text,textAnchor:"middle",dominantBaseline:"central",style:{fontSize:9,...n,fontWeight:600},children:[(i*100).toFixed(0),"%"]})},we={TREND_UP:{color:"#39DDB6",label:"TREND UP",desc:"Strong upward momentum Â· agents weighted for accumulation"},FLOW_ACCUMULATION:{color:"#39DDB6",label:"ACCUMULATING",desc:"DAG inflow detected Â· positive for KAS accumulation"},NEUTRAL:{color:"#8FA0B5",label:"NEUTRAL",desc:"No strong market signal Â· conservative sizing"},RANGE_VOL:{color:"#F7B267",label:"RANGING VOL",desc:"High volatility Â· agents reducing exposure"},RISK_OFF:{color:"#FF5D7A",label:"RISK OFF",desc:"Drawdown detected Â· capital preservation mode"}};function Ue({agents:s,activeAgentId:r,walletKas:d,kasPriceUsd:c=0,lastDecision:p,summary:i,config:x,onConfigPatch:S,onAgentOverridePatch:v,onSelectAgent:$,onRefresh:be,onDeleteAgent:O,onEditAgent:Y}){var de;const h=Array.isArray(i==null?void 0:i.rows)?i.rows:[],k=Number(c||0),m=p==null?void 0:p.dec,b=m==null?void 0:m.quant_metrics,fe=String((b==null?void 0:b.regime)||""),f=we[fe]||null,w=Number((b==null?void 0:b.daa_velocity)||0),ue=Number((m==null?void 0:m.kelly_fraction)||0),I=Number((m==null?void 0:m.confidence_score)||0),ne=Number((b==null?void 0:b.ewma_volatility)||0),oe=Number((b==null?void 0:b.sample_count)||0),ae=F.useRef({}),[se,je]=F.useState(0),[X,me]=F.useState([]),[Q,ye]=F.useState([]);F.useEffect(()=>{if(!h.length)return;const l=Date.now();je(l),ae.current=Object.fromEntries(h.map(a=>[a.agentId,Number(a.balanceKas||a.budgetKas||0)]));const o={ts:l,label:le(l)},g={ts:l,label:le(l)};for(const a of h)o[a.name]=Number(a.balanceKas||a.budgetKas||0),g[a.name]=Number(a.pnlKas||0);me(a=>[...a,o].slice(-120)),ye(a=>[...a,g].slice(-120))},[i]);const L=Math.min(100,((i==null?void 0:i.utilizationPct)||0)*.3+(100-((i==null?void 0:i.concentrationPct)||0))*.3+((i==null?void 0:i.allocatedKas)||0)/Math.max(1,(i==null?void 0:i.targetBudgetKas)||1)*40),R=L>=70?t.ok:L>=40?t.warn:t.danger,Se=L>=70?"Healthy":L>=40?"Moderate":"Needs Attention",B=h.reduce((l,o)=>l+Number(o.pnlKas||0),0),ve=Number((i==null?void 0:i.allocatedKas)||0),ke=Number((i==null?void 0:i.targetBudgetKas)||0),W=K(Number(d||0),k),M=h.map((l,o)=>({name:l.name,value:Number(l.budgetKas)||0,color:C[o%C.length]})).filter(l=>l.value>0),P=h.map(l=>({name:l.name.substring(0,12),PnL:Number(l.pnlKas||0),Balance:Number(l.balanceKas||l.budgetKas||0)})),E=h.map(l=>l.name),ze=X.length>=2&&E.length>0,Be=Q.length>=2&&E.length>0,re=l=>[`${Number(l).toFixed(4)} KAS`,""],D={background:"rgba(11,17,24,0.95)",border:`1px solid ${t.border}`,borderRadius:6,fontSize:11};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,flexWrap:"wrap",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,color:t.text,fontWeight:700,...n},children:"Portfolio"}),e.jsxs("div",{style:{fontSize:11,color:t.dim},children:["Real-time balance & PnL across all deployed agents",se>0&&e.jsxs("span",{style:{marginLeft:8,color:t.accent},children:["Â· updated ",le(se)]})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:10,color:t.dim,...n,background:"rgba(16,25,35,0.5)",padding:"4px 10px",borderRadius:4,border:"1px solid rgba(33,48,67,0.6)"},children:[h.length," agent",h.length!==1?"s":""," live"]}),e.jsx(Ke,{onClick:be,size:"sm",variant:"ghost",children:"Refresh"})]})]}),e.jsxs(N,{p:0,style:{marginBottom:14,overflow:"hidden",border:`1px solid ${f?f.color+"28":"rgba(33,48,67,0.5)"}`},children:[e.jsx("div",{style:{height:2,background:f?`linear-gradient(90deg, ${f.color}, ${t.purple})`:`linear-gradient(90deg, ${t.border}, ${t.border})`}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:0,alignItems:"stretch"},children:[e.jsxs("div",{style:{padding:"12px 16px",background:f?`linear-gradient(135deg, ${f.color}12 0%, rgba(8,13,20,0.6) 100%)`:"rgba(8,13,20,0.5)",borderRight:"1px solid rgba(33,48,67,0.4)"},children:[e.jsx("div",{style:{fontSize:8,color:t.dim,...n,letterSpacing:"0.12em",marginBottom:4},children:"MARKET REGIME"}),e.jsx("div",{style:{fontSize:13,color:(f==null?void 0:f.color)||t.dim,fontWeight:700,...n},children:(f==null?void 0:f.label)||"AWAITING CYCLE"}),e.jsx("div",{style:{fontSize:9,color:t.dim,marginTop:2,maxWidth:160},children:(f==null?void 0:f.desc)||"Run a cycle to get market intelligence"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",padding:"12px 16px",gap:12},children:[{k:"DAA Velocity",v:b?`${w>=0?"+":""}${w.toFixed(1)}`:"â€”",c:w>0?t.ok:w<0?t.danger:t.dim},{k:"EWMA Vol",v:b?`${(ne*100).toFixed(3)}%`:"â€”",c:ne>.02?t.warn:t.ok},{k:"Kelly Size",v:m?`${(ue*100).toFixed(1)}%`:"â€”",c:t.accent},{k:"Samples",v:b?String(oe):"â€”",c:oe>=32?t.ok:t.warn}].map(l=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:8,color:t.dim,...n,letterSpacing:"0.08em",marginBottom:3},children:l.k}),e.jsx("div",{style:{fontSize:12,color:l.c,fontWeight:700,...n},children:l.v})]},l.k))}),e.jsxs("div",{style:{padding:"12px 16px",borderLeft:"1px solid rgba(33,48,67,0.4)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:80},children:[e.jsx("div",{style:{fontSize:8,color:t.dim,...n,letterSpacing:"0.1em",marginBottom:6},children:"CONFIDENCE"}),e.jsx("div",{style:{fontSize:20,color:I>=.7?t.ok:I>=.5?t.warn:t.dim,fontWeight:700,...n},children:m?`${(I*100).toFixed(0)}%`:"â€”"}),m&&e.jsx("div",{style:{width:48,height:3,background:"rgba(16,25,35,0.7)",borderRadius:2,overflow:"hidden",marginTop:4},children:e.jsx("div",{style:{width:`${I*100}%`,height:"100%",background:I>=.7?t.ok:I>=.5?t.warn:t.danger,transition:"width 0.4s"}})})]})]}),k>0&&e.jsxs("div",{style:{padding:"8px 16px",borderTop:"1px solid rgba(33,48,67,0.4)",background:"rgba(8,13,20,0.4)",display:"flex",alignItems:"center",gap:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("img",{src:"/kaspa-logo.png",alt:"KAS",width:14,height:14,style:{borderRadius:"50%"}}),e.jsx("span",{style:{fontSize:10,color:t.accent,fontWeight:700,...n},children:"KAS / USDC"}),e.jsxs("span",{style:{fontSize:12,color:t.text,fontWeight:700,...n},children:["$",k.toFixed(4)]})]}),e.jsx("span",{style:{fontSize:9,color:t.dim,...n},children:"Â·"}),e.jsxs("span",{style:{fontSize:9,color:t.dim,...n},children:["Wallet: ",e.jsxs("span",{style:{color:t.text},children:[Number(d||0).toFixed(2)," KAS"]}),W&&e.jsxs("span",{style:{color:t.dim},children:[" (",W,")"]})]}),e.jsx("span",{style:{fontSize:9,color:t.dim,...n},children:"Â·"}),e.jsxs("span",{style:{fontSize:9,color:t.dim,...n},children:["P&L: ",e.jsxs("span",{style:{color:B>=0?t.ok:t.danger,fontWeight:600},children:[B>=0?"+":"",B.toFixed(4)," KAS"]})]}),((de=p==null?void 0:p.dec)==null?void 0:de.action)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontSize:9,color:t.dim,...n},children:"Â·"}),e.jsxs("span",{style:{fontSize:9,color:t.accent,fontWeight:700,...n},children:["SIGNAL: ",p.dec.action]})]})]})]}),e.jsxs(N,{p:16,style:{marginBottom:14,background:`linear-gradient(135deg, ${R}08 0%, rgba(8,13,20,0.5) 100%)`,border:`1px solid ${R}22`},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:16,alignItems:"center",marginBottom:14},children:[e.jsx($e,{value:L,color:R,size:72}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginBottom:4,letterSpacing:"0.12em"},children:"OVERALL HEALTH"}),e.jsx("div",{style:{fontSize:20,color:R,fontWeight:700,...n,marginBottom:6},children:Se}),e.jsx(ie,{value:L,color:R,height:6})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:10},children:[{label:"Wallet Balance",color:t.accent,value:e.jsx(A,{value:Number(d||0).toFixed(2),color:t.accent}),sub:W||null},{label:"Deployable",color:t.ok,value:e.jsx(A,{value:Number((i==null?void 0:i.allocatableKas)||0).toFixed(2)}),sub:K(Number((i==null?void 0:i.allocatableKas)||0),k)},{label:"Target Budget",color:t.ok,value:e.jsx(A,{value:Number((i==null?void 0:i.targetBudgetKas)||0).toFixed(2),color:t.ok}),sub:K(ke,k)},{label:"Deployed",color:t.purple,value:e.jsx(A,{value:Number((i==null?void 0:i.allocatedKas)||0).toFixed(2)}),sub:K(ve,k)},{label:"Total P&L",color:B>=0?t.ok:t.danger,value:e.jsxs("span",{style:{fontSize:14,color:B>=0?t.ok:t.danger,fontWeight:700,...n},children:[B>=0?"+":"",B.toFixed(4)," KAS"]}),sub:K(Math.abs(B),k)?`${B>=0?"+":"-"}${K(Math.abs(B),k)}`:null}].map(({label:l,value:o,sub:g,color:a})=>e.jsxs("div",{style:{background:`linear-gradient(135deg, ${a}10 0%, rgba(8,13,20,0.55) 100%)`,borderRadius:8,padding:"10px 12px",border:`1px solid ${a}18`},children:[e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginBottom:4,letterSpacing:"0.08em"},children:l}),e.jsx("div",{style:{fontSize:14,fontWeight:700,...n},children:o}),g&&e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginTop:2},children:g})]},l))})]}),h.length>0&&e.jsxs(N,{p:14,style:{marginBottom:14},children:[e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginBottom:14,letterSpacing:"0.12em"},children:"ALLOCATION BY AGENT"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:M.length>0?"1fr auto":"1fr",gap:16,alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:h.map((l,o)=>{const g=Number(l.budgetKas||0),a=h.reduce((j,H)=>j+Number(H.budgetKas||0),0),u=a>0?g/a*100:0,y=C[o%C.length],U=K(g,k);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:y,flexShrink:0,boxShadow:`0 0 6px ${y}60`}}),e.jsxs("div",{style:{flex:1,minWidth:100},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("span",{style:{fontSize:11,color:t.text,...n},children:l.name}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("span",{style:{fontSize:11,color:y,...n},children:[g.toFixed(2)," KAS"]}),U&&e.jsxs("span",{style:{fontSize:9,color:t.dim,...n,marginLeft:4},children:["(",U,")"]})]})]}),e.jsx(ie,{value:u,color:y,height:5})]}),e.jsxs("span",{style:{fontSize:11,color:t.dim,...n,minWidth:36,textAlign:"right"},children:[u.toFixed(0),"%"]})]},l.agentId)})}),M.length>0&&e.jsx("div",{style:{flexShrink:0},children:e.jsxs(Ae,{width:130,height:130,children:[e.jsx(Ie,{data:M,cx:60,cy:60,innerRadius:32,outerRadius:58,dataKey:"value",labelLine:!1,label:Fe,children:M.map((l,o)=>e.jsx(xe,{fill:l.color,opacity:.88},o))}),e.jsx(G,{formatter:l=>[`${l.toFixed(2)} KAS`,""],contentStyle:D})]})})]})]}),h.length>0&&e.jsxs(N,{p:14,style:{marginBottom:14},children:[e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginBottom:12,letterSpacing:"0.12em"},children:"P&L COMPARISON"}),P.length>0?e.jsx(Z,{width:"100%",height:180,children:e.jsxs(Le,{data:P,margin:{top:5,right:5,left:0,bottom:5},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"rgba(33,48,67,0.4)"}),e.jsx(ee,{dataKey:"name",tick:{fontSize:10,fill:t.dim}}),e.jsx(te,{tick:{fontSize:10,fill:t.dim}}),e.jsx(G,{formatter:(l,o)=>[`${l.toFixed(4)} KAS`,o==="PnL"?"P&L":"Balance"],contentStyle:D}),e.jsx(Te,{dataKey:"PnL",radius:[4,4,0,0],children:P.map((l,o)=>e.jsx(xe,{fill:(P[o].PnL??0)>=0?t.ok:t.danger},o))})]})}):e.jsx("div",{style:{height:180,display:"flex",alignItems:"center",justifyContent:"center",color:t.dim,fontSize:12},children:"No P&L data yet"})]}),ze&&e.jsxs(N,{p:14,style:{marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{style:{fontSize:9,color:t.accent,fontWeight:700,...n,letterSpacing:"0.1em"},children:"âš¡ LIVE BALANCE COMPARE"}),e.jsxs("span",{style:{fontSize:9,color:t.dim,...n},children:[X.length," snapshots"]})]}),e.jsx(Z,{width:"100%",height:200,children:e.jsxs(ge,{data:X,margin:{top:4,right:8,left:0,bottom:4},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"rgba(33,48,67,0.4)"}),e.jsx(ee,{dataKey:"label",tick:{fontSize:9,fill:t.dim},interval:"preserveStartEnd"}),e.jsx(te,{tick:{fontSize:9,fill:t.dim},width:55,tickFormatter:l=>`${l.toFixed(1)}`}),e.jsx(G,{formatter:re,contentStyle:D,labelStyle:{color:t.dim,fontSize:10}}),e.jsx(he,{wrapperStyle:{fontSize:10,color:t.dim}}),E.map((l,o)=>e.jsx(pe,{type:"monotone",dataKey:l,stroke:C[o%C.length],strokeWidth:2,dot:!1,isAnimationActive:!1},l))]})})]}),Be&&e.jsxs(N,{p:14,style:{marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{style:{fontSize:9,color:t.ok,fontWeight:700,...n,letterSpacing:"0.1em"},children:"ðŸ“ˆ LIVE P&L HISTORY"}),e.jsxs("span",{style:{fontSize:9,color:t.dim,...n},children:[Q.length," snapshots"]})]}),e.jsx(Z,{width:"100%",height:180,children:e.jsxs(ge,{data:Q,margin:{top:4,right:8,left:0,bottom:4},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"rgba(33,48,67,0.4)"}),e.jsx(ee,{dataKey:"label",tick:{fontSize:9,fill:t.dim},interval:"preserveStartEnd"}),e.jsx(te,{tick:{fontSize:9,fill:t.dim},width:60,tickFormatter:l=>`${l>=0?"+":""}${l.toFixed(3)}`}),e.jsx(G,{formatter:re,contentStyle:D,labelStyle:{color:t.dim,fontSize:10}}),e.jsx(he,{wrapperStyle:{fontSize:10,color:t.dim}}),E.map((l,o)=>e.jsx(pe,{type:"monotone",dataKey:l,stroke:C[o%C.length],strokeWidth:2,dot:!1,isAnimationActive:!1},l))]})})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(130px,1fr))",gap:10,marginBottom:14},children:[{label:"Budget Utilization",value:V(i==null?void 0:i.utilizationPct,1),color:((i==null?void 0:i.utilizationPct)||0)>=80?t.ok:t.warn,sub:"target 80%+"},{label:"Concentration",value:V(i==null?void 0:i.concentrationPct,1),color:((i==null?void 0:i.concentrationPct)||0)>55?t.warn:t.ok,sub:"lower = diversified"},{label:"Active Agents",value:String(Array.isArray(s)?s.length:0),color:t.text,sub:"in pool"}].map(({label:l,value:o,color:g,sub:a})=>e.jsxs(N,{p:14,style:{background:`linear-gradient(135deg, ${g}10 0%, rgba(8,13,20,0.5) 100%)`,border:`1px solid ${g}20`},children:[e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginBottom:4,letterSpacing:"0.08em"},children:l}),e.jsx("div",{style:{fontSize:20,color:g,fontWeight:700,...n},children:o}),e.jsx("div",{style:{fontSize:9,color:t.dim,marginTop:4},children:a})]},l))}),e.jsx(N,{p:14,style:{marginBottom:14},children:e.jsxs("details",{children:[e.jsxs("summary",{style:{cursor:"pointer",listStyle:"none",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:11,color:t.dim,...n},children:"Advanced Allocator Settings"}),e.jsx("span",{style:{fontSize:10,color:t.dim},children:"â–¼"})]}),e.jsxs("div",{style:{marginTop:14,display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(200px,1fr))",gap:12},children:[e.jsx(T,{label:"Total Budget % of Wallet",value:String(Math.round(Number((x==null?void 0:x.totalBudgetPct)||0)*1e4)/100),onChange:l=>S({totalBudgetPct:Math.max(5,Math.min(100,Number(l)||0))/100}),type:"number",suffix:"%",hint:"What percentage of your wallet balance agents can use"}),e.jsx(T,{label:"Reserve (always keep)",value:String((x==null?void 0:x.reserveKas)??0),onChange:l=>S({reserveKas:Math.max(0,Number(l)||0)}),type:"number",suffix:"KAS",hint:"KAS to always keep untouched"}),e.jsx(T,{label:"Max Per Agent %",value:String(Math.round(Number((x==null?void 0:x.maxAgentAllocationPct)||0)*1e4)/100),onChange:l=>S({maxAgentAllocationPct:Math.max(5,Math.min(100,Number(l)||0))/100}),type:"number",suffix:"%",hint:"No single agent can get more than this share"}),e.jsx(T,{label:"Rebalance Threshold %",value:String(Math.round(Number((x==null?void 0:x.rebalanceThresholdPct)||0)*1e4)/100),onChange:l=>S({rebalanceThresholdPct:Math.max(1,Math.min(50,Number(l)||0))/100}),type:"number",suffix:"%",hint:"Only trigger rebalance when drift exceeds this"})]})]})}),e.jsxs(N,{p:0,children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(33,48,67,0.5)",background:"rgba(8,13,20,0.5)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:9,color:t.dim,...n,letterSpacing:"0.12em"},children:"AGENTS Â· REAL-TIME"}),e.jsxs("span",{style:{fontSize:9,color:t.dim,...n},children:[h.length," in pool"]})]}),h.length===0&&e.jsx("div",{style:{padding:32,textAlign:"center",fontSize:12,color:t.dim},children:"No agents deployed yet."}),h.map((l,o)=>{const g=l.agentId===r,a=l.risk<=.4?t.ok:l.risk<=.7?t.warn:t.danger,u=Number(l.pnlKas||0),y=Number(l.balanceKas||l.budgetKas||0),U=ae.current[l.agentId]??y,j=C[o%C.length],H=K(y,k),_=K(Math.abs(u),k);return e.jsxs("div",{style:{padding:"14px 16px",borderBottom:"1px solid rgba(33,48,67,0.4)",background:g?`linear-gradient(135deg, ${j}08 0%, rgba(8,13,20,0.3) 100%)`:"transparent",borderLeft:g?`2px solid ${j}`:"2px solid transparent"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10,flexWrap:"wrap",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:j,display:"inline-block",flexShrink:0,boxShadow:`0 0 8px ${j}80`}}),e.jsx("button",{onClick:()=>$==null?void 0:$(l.agentId),style:{background:g?`${j}18`:"rgba(16,25,35,0.4)",border:`1px solid ${g?j:"rgba(33,48,67,0.6)"}`,color:g?j:t.text,borderRadius:6,padding:"6px 12px",cursor:"pointer",fontSize:12,fontWeight:600,...n},children:l.name}),e.jsx(J,{text:l.enabled?"Active":"Disabled",color:l.enabled?t.ok:t.dim}),e.jsx(Re,{value:y,prev:U})]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:12,color:u>=0?t.ok:t.danger,fontWeight:700,...n},children:[u>=0?"â–² +":"â–¼ ",u.toFixed(4)," KAS",_&&e.jsxs("span",{style:{fontSize:9,color:t.dim,marginLeft:4},children:["(",u>=0?"+":"-",_,")"]})]}),e.jsx(J,{text:`Risk: ${l.risk<=.4?"Low":l.risk<=.7?"Med":"High"}`,color:a}),e.jsx("button",{onClick:()=>Y==null?void 0:Y(l),title:"Edit agent",style:{background:"rgba(16,25,35,0.5)",border:"1px solid rgba(57,221,182,0.12)",color:t.dim,borderRadius:4,padding:"4px 8px",cursor:"pointer",fontSize:11,...n},children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>{window.confirm(`Delete agent "${l.name}"? This cannot be undone.`)&&(O==null||O(l.agentId))},title:"Delete agent",style:{background:t.dLow,border:`1px solid ${t.danger}50`,color:t.danger,borderRadius:4,padding:"4px 8px",cursor:"pointer",fontSize:11,...n},children:"ðŸ—‘ï¸ Delete"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(100px,1fr))",gap:8,marginBottom:10},children:[{label:"Cycle Budget",value:e.jsx(A,{value:l.cycleCapKas,color:t.ok}),hint:"Max KAS this agent can trade per cycle",c:t.ok},{label:"Total Budget",value:e.jsx(A,{value:l.budgetKas}),hint:"Total KAS allocated",c:t.dim},{label:"Live Balance",c:j,value:e.jsxs("div",{children:[e.jsx(A,{value:y.toFixed(4),color:j}),H&&e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginTop:1},children:H})]}),hint:"Current balance for this agent"},{label:"P&L",c:u>=0?t.ok:t.danger,value:e.jsxs("div",{children:[e.jsxs("span",{style:{fontSize:13,fontWeight:600,...n,color:u>=0?t.ok:t.danger},children:[u>=0?"+":"",u.toFixed(4)," KAS"]}),_&&e.jsxs("div",{style:{fontSize:9,color:t.dim,...n,marginTop:1},children:[u>=0?"+":"-",_]})]}),hint:`PnL (${l.pnlMode||"estimated"})`},{label:"Portfolio Share",value:V(l.targetPct,1),hint:"Target % of total portfolio",c:t.purple},{label:"Queue Pressure",value:V(l.queuePressurePct,1),hint:"How busy the execution queue is",c:t.dim}].map(({label:z,value:Ce,hint:Ne,c:ce})=>e.jsxs("div",{title:Ne,style:{background:`linear-gradient(135deg, ${ce}08 0%, rgba(8,13,20,0.5) 100%)`,borderRadius:6,padding:"8px 10px",border:`1px solid ${ce}14`},children:[e.jsx("div",{style:{fontSize:9,color:t.dim,...n,marginBottom:2,letterSpacing:"0.08em"},children:z}),e.jsx("div",{style:{fontSize:13,fontWeight:600,...n},children:Ce})]},z))}),y>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("span",{style:{fontSize:9,color:t.dim,...n},children:"Balance vs Budget"}),e.jsxs("span",{style:{fontSize:9,color:j,...n},children:[(y/Math.max(1,Number(l.budgetKas))*100).toFixed(1),"%"]})]}),e.jsx(ie,{value:y/Math.max(1,Number(l.budgetKas))*100,color:j,height:4})]}),(l.notes||[]).length>0&&e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginBottom:10},children:(l.notes||[]).map(z=>e.jsx(J,{text:z.replace(/_/g," "),color:t.warn},z))}),e.jsxs("details",{children:[e.jsx("summary",{style:{cursor:"pointer",listStyle:"none"},children:e.jsx("span",{style:{fontSize:9,color:t.dim,...n},children:"Override settings â–¼"})}),e.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(140px,1fr))",gap:10},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,background:"rgba(16,25,35,0.5)",padding:"10px 12px",borderRadius:6,cursor:"pointer",border:"1px solid rgba(33,48,67,0.5)"},children:[e.jsx("input",{type:"checkbox",checked:l.enabled,onChange:z=>v==null?void 0:v(l.agentId,{enabled:z.target.checked}),style:{width:16,height:16,accentColor:t.accent}}),e.jsx("span",{style:{fontSize:11,color:t.text,...n},children:"Enabled"})]}),e.jsx(T,{label:"Target Allocation %",value:String(l.targetPct),onChange:z=>v==null?void 0:v(l.agentId,{targetAllocationPct:Math.max(0,Math.min(100,Number(z)||0))}),type:"number",suffix:"%",hint:"Desired portfolio share for this agent"}),e.jsx(T,{label:"Risk Weight",value:String(l.riskWeight),onChange:z=>v==null?void 0:v(l.agentId,{riskWeight:Math.max(0,Math.min(10,Number(z)||0))}),type:"number",hint:"Allocator weight multiplier"})]})]})]},l.agentId)})]})]})}export{Ue as PortfolioPanel};
