import{j as t}from"./react-vendor-D4yGots9.js";import{m as l,a as i,B as c,C as S,L as M}from"./index-zj7ZcTer.js";function O({summary:e}){const $=Array.isArray(e==null?void 0:e.rows)?e.rows:[],h=Number(((e==null?void 0:e.netPnlKas)??(e==null?void 0:e.estimatedNetPnlKas))||0),g=String((e==null?void 0:e.netPnlMode)||"estimated"),b=Number((e==null?void 0:e.executedSignals)||0),j=Number((e==null?void 0:e.signalQualityScore)||0),f=Number((e==null?void 0:e.timingAlphaPct)||0),o=Math.max(1,Number((e==null?void 0:e.realizedMinConfirmations)||1)),p=Math.max(1,Number((e==null?void 0:e.confirmationFloorObservedMin)||o)),v=Math.max(p,Number((e==null?void 0:e.confirmationFloorObservedMax)||p)),C=Number((e==null?void 0:e.confidenceBrierScore)||0),R=Number((e==null?void 0:e.evCalibrationErrorPct)||0),N=Number((e==null?void 0:e.realizedVsExpectedEdgeKas)||0),F=Number((e==null?void 0:e.regimeHitRatePct)||0),P=Number((e==null?void 0:e.regimeHitSamples)||0),E=!!(e!=null&&e.truthDegraded),k=Number((e==null?void 0:e.truthMismatchRatePct)||0),A=Number((e==null?void 0:e.truthCheckedSignals)||0),B=Number((e==null?void 0:e.truthMismatchSignals)||0),z=String((e==null?void 0:e.truthDegradedReason)||""),r=g==="realized"?"Realized":g==="hybrid"?"Hybrid":"Estimated";return t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:14},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[t.jsxs("div",{style:{fontSize:13,color:i.text,fontWeight:700,...l},children:["PnL Attribution (",r,")"]}),t.jsx(c,{text:`REALIZED FLOOR ${o} CONF`,color:o<=1?i.dim:i.warn}),t.jsx(c,{text:`FLOOR RANGE ${p}${p!==v?`-${v}`:""} CONF`,color:v>o?i.warn:i.dim})]}),t.jsx("div",{style:{fontSize:11,color:i.dim},children:g==="realized"?`Executed signals are fully receipt-confirmed with chain confirmation timestamps and a ${o}-confirmation realized floor.`:g==="hybrid"?`Confirmed receipts at or above ${o} confirmation${o===1?"":"s"} use realized broadcast→confirmation execution drift; remaining execution costs stay estimated.`:"Attribution is estimated from quant expected value, queue execution outcomes, fee logs, liquidity buckets, and market snapshots."}),E&&t.jsxs("div",{style:{fontSize:11,color:i.danger,marginTop:8},children:["Truth degraded: backend/chain receipt mismatch rate ",k.toFixed(1),"% (",B,"/",A," checks). Realized mode is downgraded until receipt consistency recovers.",z?` (${z})`:""]}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:10},children:[t.jsx(c,{text:`CHAIN ${Number((e==null?void 0:e.provenanceChainSignals)||0)}/${b}`,color:Number((e==null?void 0:e.provenanceChainSignals)||0)>0?i.ok:i.dim}),t.jsx(c,{text:`BACKEND ${Number((e==null?void 0:e.provenanceBackendSignals)||0)}/${b}`,color:Number((e==null?void 0:e.provenanceBackendSignals)||0)>0?i.purple:i.dim}),t.jsx(c,{text:`ESTIMATED ${Number((e==null?void 0:e.provenanceEstimatedSignals)||0)}/${b}`,color:Number((e==null?void 0:e.provenanceEstimatedSignals)||0)>0?i.warn:i.dim}),E&&t.jsx(c,{text:"TRUTH DEGRADED",color:i.danger})]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:10,marginBottom:12},children:[[g==="realized"?"Net PnL (realized)":g==="hybrid"?"Net PnL (hybrid)":"Net PnL (est)",`${h>=0?"+":""}${h.toFixed(4)} KAS`,h>=0?i.ok:i.danger],["Fill Rate",`${Number((e==null?void 0:e.fillRatePct)||0).toFixed(1)}%`,Number((e==null?void 0:e.fillRatePct)||0)>=70?i.ok:i.warn],["Confirmed Receipts",`${Number((e==null?void 0:e.confirmedSignals)||0)}`,Number((e==null?void 0:e.confirmedSignals)||0)>0?i.ok:i.dim],["Receipt Coverage",`${Number((e==null?void 0:e.receiptCoveragePct)||0).toFixed(1)}%`,Number((e==null?void 0:e.receiptCoveragePct)||0)>=50?i.ok:i.warn],["Realized Receipt Coverage",`${Number((e==null?void 0:e.realizedReceiptCoveragePct)||0).toFixed(1)}%`,Number((e==null?void 0:e.realizedReceiptCoveragePct)||0)>=50?i.ok:i.warn],["Chain Fee Coverage",`${Number((e==null?void 0:e.chainFeeCoveragePct)||0).toFixed(1)}%`,Number((e==null?void 0:e.chainFeeCoveragePct)||0)>=50?i.ok:i.warn],["Signal Quality",`${j.toFixed(3)}`,j>=.65?i.ok:i.warn],["Conf Brier (↓)",`${C.toFixed(4)}`,C<=.2?i.ok:i.warn],["EV Cal Error",`${R.toFixed(3)}%`,R<=1.5?i.ok:i.warn],["Regime Hit",`${F.toFixed(1)}% (${P})`,F>=55?i.ok:i.warn],["Realized vs Exp Edge",`${N>=0?"+":""}${N.toFixed(4)} KAS`,N>=0?i.ok:i.warn],["Timing Alpha",`${f>=0?"+":""}${f.toFixed(3)}%`,f>=0?i.ok:i.warn],["Avg Confidence",`${Number((e==null?void 0:e.avgSignalConfidence)||0).toFixed(3)}`,i.text],["Avg EV",`${Number((e==null?void 0:e.avgExpectedValuePct)||0).toFixed(3)}%`,i.text],["Missed Fill",`${Number((e==null?void 0:e.missedFillKas)||0).toFixed(4)} KAS`,Number((e==null?void 0:e.missedFillKas)||0)>0?i.warn:i.ok],["Timing Wins",`${Number((e==null?void 0:e.timingWins)||0)}/${Number((e==null?void 0:e.timingSamples)||0)}`,i.dim]].map(([n,d,x])=>t.jsxs(S,{p:12,children:[t.jsx("div",{style:{fontSize:10,color:i.dim,...l,marginBottom:4},children:n}),t.jsx("div",{style:{fontSize:13,color:x,fontWeight:700,...l},children:d})]},String(n)))}),t.jsxs(S,{p:0,style:{marginBottom:12},children:[t.jsx("div",{style:{padding:"11px 16px",borderBottom:`1px solid ${i.border}`},children:t.jsx("span",{style:{fontSize:11,color:i.dim,...l},children:"ATTRIBUTION BREAKDOWN"})}),$.length===0&&t.jsx("div",{style:{padding:16,fontSize:12,color:i.dim},children:"Run more cycles to build attribution history."}),$.map(n=>{const d=Number((n==null?void 0:n.value)||0),x=d>=0?i.ok:i.danger;return t.jsxs("div",{style:{padding:"10px 16px",borderBottom:`1px solid ${i.border}`},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,alignItems:"center",marginBottom:4},children:[t.jsx("div",{style:{fontSize:12,color:i.text,...l},children:n==null?void 0:n.label}),t.jsx(c,{text:`${d>=0?"+":""}${d.toFixed(4)}${String((n==null?void 0:n.label)||"").includes("Alpha")?"%":" KAS"}`,color:x})]}),(n==null?void 0:n.hint)&&t.jsx("div",{style:{fontSize:11,color:i.dim},children:n.hint})]},String(n==null?void 0:n.label))})]}),t.jsxs(S,{p:14,children:[t.jsx(M,{children:"Execution Funnel"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:8},children:[["Actionable Signals",(e==null?void 0:e.actionableSignals)??0,i.text],["Executed",(e==null?void 0:e.executedSignals)??0,i.ok],["Pending",(e==null?void 0:e.pendingSignals)??0,i.warn],["Rejected",(e==null?void 0:e.rejectedSignals)??0,i.danger]].map(([n,d,x])=>t.jsxs("div",{style:{background:i.s2,borderRadius:6,padding:"9px 12px"},children:[t.jsx("div",{style:{fontSize:10,color:i.dim,...l,marginBottom:3},children:n}),t.jsx("div",{style:{fontSize:13,color:x,fontWeight:700,...l},children:d})]},String(n)))})]})]})}export{O as PnlAttributionPanel};
