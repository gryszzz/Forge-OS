import{j as e}from"./react-vendor-D4yGots9.js";import{m as i,a as s,B as m,C as o,L as x,I as n,b as h}from"./index-DKkH4U3d.js";const C=[["risk_event","Risk Events"],["queue_pending","Queue Pending"],["ai_outage","AI Outage"],["regime_shift","Regime Shifts"],["system","System"]];function I({config:r,onPatch:l,onToggleType:b,onSave:j,onTest:y,saving:d,lastResult:a}){return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8,flexWrap:"wrap",marginBottom:14},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,color:s.text,fontWeight:700,...i},children:"Alerts & Notifications"}),e.jsx("div",{style:{fontSize:11,color:s.dim},children:"Telegram, Discord, and email-webhook alerts for risk events, queue backlog, AI outages, and regime shifts."})]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx(m,{text:r!=null&&r.enabled?"ALERTS ON":"ALERTS OFF",color:r!=null&&r.enabled?s.ok:s.warn,dot:!0}),(a==null?void 0:a.reason)&&e.jsx(m,{text:String(a.reason).toUpperCase(),color:a.sent?s.ok:s.warn})]})]}),e.jsxs(o,{p:14,style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,flexWrap:"wrap",marginBottom:10},children:[e.jsx(x,{children:"Routing"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:11,color:s.dim,...i},children:[e.jsx("input",{type:"checkbox",checked:!!(r!=null&&r.enabled),onChange:t=>l({enabled:t.target.checked})}),"ENABLE ALERTING"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(230px,1fr))",gap:10},children:[e.jsx(n,{label:"Discord Webhook URL",value:(r==null?void 0:r.discordWebhookUrl)||"",onChange:t=>l({discordWebhookUrl:t}),hint:"Discord incoming webhook (optional)."}),e.jsx(n,{label:"Telegram Bot API URL",value:(r==null?void 0:r.telegramBotApiUrl)||"",onChange:t=>l({telegramBotApiUrl:t}),hint:"Example: https://api.telegram.org/bot<token>/sendMessage"}),e.jsx(n,{label:"Telegram Chat ID",value:(r==null?void 0:r.telegramChatId)||"",onChange:t=>l({telegramChatId:t}),hint:"Required if Telegram route is configured."}),e.jsx(n,{label:"Email Webhook URL",value:(r==null?void 0:r.emailWebhookUrl)||"",onChange:t=>l({emailWebhookUrl:t}),hint:"Your backend endpoint that sends email notifications."}),e.jsx(n,{label:"Min Alert Interval",value:String((r==null?void 0:r.minIntervalSec)||90),onChange:t=>l({minIntervalSec:Math.max(15,Math.min(3600,Number(t)||90))}),type:"number",suffix:"sec",hint:"Per-alert-key throttle to avoid spam."})]})]}),e.jsxs(o,{p:14,style:{marginBottom:12},children:[e.jsx(x,{children:"Event Types"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:8},children:C.map(([t,u])=>{var p;return e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,background:s.s2,border:`1px solid ${s.border}`,borderRadius:6,padding:"10px 12px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:!!((p=r==null?void 0:r.eventToggles)!=null&&p[t]),onChange:k=>b(t,k.target.checked)}),e.jsx("span",{style:{fontSize:11,color:s.text,...i},children:u.toUpperCase()})]},t)})})]}),e.jsxs(o,{p:14,children:[e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx(h,{onClick:j,disabled:d,children:d?"SAVING...":"SAVE ALERT CONFIG"}),e.jsx(h,{onClick:y,variant:"ghost",disabled:d,children:"SEND TEST ALERT"})]}),a&&e.jsxs("div",{style:{marginTop:10,fontSize:11,color:a.sent?s.ok:s.warn,...i},children:[a.sent?`Alert sent${a.sentCount?` (${a.sentCount} route${a.sentCount>1?"s":""})`:""}`:`Alert not sent: ${a.reason||"unknown"}`,Array.isArray(a.failures)&&a.failures.length>0?` Â· ${a.failures.join(" | ")}`:""]})]})]})}export{I as AlertsPanel};
